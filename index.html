<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ç»ˆæœ«åœ°åŸºè´¨è§„åˆ’å™¨ (Endfield Essence Planner)</title>
    <meta
      name="description"
      content="ç»ˆæœ«åœ°åŸºè´¨è§„åˆ’å™¨ï¼šæ ¹æ®é™„åŠ /æŠ€èƒ½å±æ€§æ± ä¸é”å®šè§„åˆ™ï¼Œè‡ªåŠ¨è®¡ç®—å¤šæ­¦å™¨å…±åˆ·æ–¹æ¡ˆï¼Œæä¾›åŸºç¡€å±æ€§å†²çªæç¤ºä¸å¯åˆ·æ•°é‡å‚è€ƒï¼Œé€‚é…ç§»åŠ¨ç«¯ã€‚"
    />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://end.canmoe.com/" />
    <meta name="copyright" content="Â© 2026 ç’¨æ¢¦è¸æœˆ" />
    <meta name="license" content="AGPL-3.0" />
    <meta name="source" content="https://github.com/cmyyx/endfield-essence-planner" />
    <meta name="contact" content="contact@canmoe.com" />
    <meta name="fingerprint" content="cmty-ep-2026-02-07" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="ç»ˆæœ«åœ°åŸºè´¨è§„åˆ’å™¨ (Endfield Essence Planner)" />
    <meta
      property="og:description"
      content="ç»ˆæœ«åœ°åŸºè´¨è§„åˆ’å™¨ï¼šæ ¹æ®é™„åŠ /æŠ€èƒ½å±æ€§æ± ä¸é”å®šè§„åˆ™ï¼Œè‡ªåŠ¨è®¡ç®—å¤šæ­¦å™¨å…±åˆ·æ–¹æ¡ˆï¼Œæä¾›åŸºç¡€å±æ€§å†²çªæç¤ºä¸å¯åˆ·æ•°é‡å‚è€ƒï¼Œé€‚é…ç§»åŠ¨ç«¯ã€‚"
    />
    <meta property="og:url" content="https://end.canmoe.com/" />
    <meta property="og:site_name" content="ç»ˆæœ«åœ°åŸºè´¨è§„åˆ’å™¨" />
    <meta name="twitter:card" content="summary" />
    <link rel="icon" href="./favicon.ico" sizes="any" />
    <link rel="icon" type="image/png" sizes="96x96" href="./favicon-96x96.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png" />
    <meta name="theme-color" content="#0f1521" />
    <!-- æœ¬åœ°ä¾èµ–ï¼ˆè¯·å°†æ–‡ä»¶æ”¾åˆ° ./vendor/ï¼‰ -->
    <script
      defer
      src="https://umami.canmoe.com/umcmx.js"
      data-website-id="98084554-f35b-4100-8bd4-262f490c9ae2"
    ></script>
    <script>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?675464d4b6500379e28adbfeb2ce0b40";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FQ81EJB28L"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-FQ81EJB28L");
    </script>
    <script type="text/javascript">
      (function (c, l, a, r, i, t, y) {
        c[a] =
          c[a] ||
          function () {
            (c[a].q = c[a].q || []).push(arguments);
          };
        t = l.createElement(r);
        t.async = 1;
        t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0];
        y.parentNode.insertBefore(t, y);
      })(window, document, "clarity", "script", "vb1z842wno");
    </script>
    <style>
      html.preload body {
        background: #0b0f14;
        color: #e6e9ef;
      }
      @media (prefers-color-scheme: light) {
        html.preload body {
          background: #eef3fb;
          color: #1c2b3f;
        }
      }
      html.preload #app {
        display: none;
      }
      [v-cloak] {
        display: none;
      }
      #app-preload {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(6, 8, 12, 0.55);
        color: #e6e9ef;
        font-family: "Microsoft YaHei UI", "PingFang SC", sans-serif;
        z-index: 9999;
        opacity: 1;
        transition: opacity 0.2s ease;
      }
      #app-preload.preload-hide {
        opacity: 0;
        pointer-events: none;
      }
      #app-preload .preload-card {
        padding: 16px 18px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: rgba(14, 20, 30, 0.85);
        text-align: center;
      }
      #app-preload .preload-title {
        font-size: 14px;
        letter-spacing: 0.08em;
        margin-bottom: 6px;
      }
      #app-preload .preload-sub {
        font-size: 12px;
        color: #9aa5b1;
      }
    </style>
    <script>
      (function () {
        const root = document.documentElement;
        root.classList.add("preload");
        const version = (document.lastModified || String(Date.now())).replace(/\D/g, "");
        root.dataset.assetVersion = version;
        const finish = () => {
          if (!root.classList.contains("preload")) return;
          root.classList.remove("preload");
          const overlay = document.getElementById("app-preload");
          if (overlay) {
            overlay.classList.add("preload-hide");
            setTimeout(() => overlay.remove(), 240);
          }
        };
        window.__finishPreload = finish;
        const cssFiles = [
          "./css/styles.theme.css",
          "./css/styles.layout.css",
          "./css/styles.overlays.css",
          "./css/styles.filters.css",
          "./css/styles.weapons.css",
          "./css/styles.recommendations.css",
          "./css/styles.theme.modes.css",
        ];
        cssFiles.forEach((href) => {
          const link = document.createElement("link");
          link.rel = "stylesheet";
          link.href = href + "?v=" + version;
          document.head.appendChild(link);
        });
        setTimeout(finish, 8000);
      })();
    </script>

  </head>
  <body>
    <div id="app-preload">
      <div class="preload-card">
        <div class="preload-title">å°‘å¥³ç¥ˆç¥·ä¸­</div>
        <div class="preload-sub">é¦–æ¬¡æ‰“å¼€æˆ–å¼ºåˆ¶åˆ·æ–°å¯èƒ½ç¨æ…¢</div>
      </div>
    </div>
    <div id="app" class="app-shell" v-cloak v-show="appReady" data-fingerprint="cmty-ep-2026-02-07">
      <header class="hero">
        <div class="hero-title">
          <h1>{{ t("ç»ˆæœ«åœ°åŸºè´¨è§„åˆ’å™¨") }}</h1>
        </div>
        <div class="hero-actions">
          <div class="lang-switch" ref="langSwitchRef" @click.stop>
            <button
              class="lang-button"
              type="button"
              aria-label="Language"
              aria-haspopup="listbox"
              :aria-expanded="showLangMenu ? 'true' : 'false'"
              @click="toggleLangMenu"
            >
              <span class="lang-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
                  <circle cx="12" cy="12" r="9"></circle>
                  <path d="M3 12h18"></path>
                  <path d="M12 3a13 13 0 0 1 0 18"></path>
                  <path d="M12 3a13 13 0 0 0 0 18"></path>
                </svg>
              </span>
              <span class="lang-label">Language</span>
            </button>
            <div v-if="showLangMenu" class="lang-menu" :class="'align-' + langMenuPlacement" role="listbox">
              <button
                v-for="option in languageOptions"
                :key="option.value"
                class="lang-option"
                :class="{ active: option.value === locale }"
                role="option"
                :aria-selected="option.value === locale"
                @click="setLocale(option.value)"
              >
                {{ option.label }}
              </button>
            </div>
          </div>
          <div class="theme-switch" @click.stop>
            <label class="theme-label" for="theme-mode-select">{{ t("ç•Œé¢ä¸»é¢˜") }}</label>
            <select
              id="theme-mode-select"
              class="theme-select"
              :value="themePreference"
              @change="setThemeMode($event.target.value)"
            >
              <option value="auto">{{ t("è‡ªåŠ¨") }}</option>
              <option value="light">{{ t("æ—¥é—´") }}</option>
              <option value="dark">{{ t("å¤œé—´") }}</option>
            </select>
          </div>
          <button class="about-button notice-button" @click="openNotice">{{ t("å…¬å‘Š") }}</button>
          <button class="about-button" @click="showChangelog = true">{{ t("æ›´æ–°æ—¥å¿—") }}</button>
          <button class="about-button" @click="showAbout = true">{{ t("å…³äº") }}</button>
          <div class="secondary-menu">
            <button class="ghost-button menu-toggle" @click="showSecondaryMenu = !showSecondaryMenu">
              {{ t("æ›´å¤šè®¾ç½®") }}
            </button>
            <div v-if="showSecondaryMenu" class="secondary-panel">
              <div class="secondary-item">
                <div class="secondary-label">{{ t("æ€§èƒ½æ¨¡å¼") }}</div>
                <select class="secondary-select" :value="perfPreference" @change="setPerfMode($event.target.value)">
                  <option value="auto">{{ t("è‡ªåŠ¨") }}</option>
                  <option value="standard">{{ t("æ ‡å‡†") }}</option>
                  <option value="low">{{ t("ä½GPU") }}</option>
                </select>
                <div v-if="perfPreference === 'auto'" class="secondary-hint">
                  {{ t("å½“å‰è‡ªåŠ¨ï¼š") }}{{ lowGpuEnabled ? t("ä½GPU") : t("æ ‡å‡†") }}
                </div>
              </div>
              <div class="secondary-item secondary-desc">
                {{ t("è‡ªåŠ¨æ¨¡å¼ä¼šæ ¹æ®æ¸²æŸ“æ€§èƒ½ä¸´æ—¶åˆ‡æ¢ä½GPUæ¨¡å¼ã€‚") }}
              </div>
              <div class="secondary-item">
                <div class="secondary-label">{{ t("èƒŒæ™¯å›¾ç‰‡") }}</div>
                <div class="secondary-actions">
                  <label class="ghost-button secondary-upload">
                    {{ t("å¯¼å…¥å›¾ç‰‡") }}
                    <input type="file" accept="image/*" @change="handleBackgroundFile" />
                  </label>
                  <button
                    class="ghost-button"
                    @click="clearCustomBackground"
                    :disabled="!customBackground && !customBackgroundApi"
                  >
                    {{ t("æ¢å¤é»˜è®¤") }}
                  </button>
                </div>
                <div v-if="customBackgroundName" class="secondary-hint secondary-file">
                  {{ t("å½“å‰ï¼š") }}{{ customBackgroundName }}
                </div>
                <div v-else class="secondary-hint">{{ t("æœªå¯¼å…¥æ—¶ä½¿ç”¨éšæœºèƒŒæ™¯") }}</div>
                <input
                  class="secondary-input"
                  type="text"
                  v-model.trim.lazy="customBackgroundApi"
                  :placeholder="t('è‡ªå®šä¹‰å›¾ç‰‡APIï¼ˆè¿”å›å›¾ç‰‡ï¼‰')"
                />
                <div v-if="customBackgroundApi" class="secondary-hint secondary-file">
                  {{ t("APIï¼š") }}{{ customBackgroundApi }}
                </div>
                <div v-else class="secondary-hint">{{ t("æœªè®¾ç½®APIæ—¶ä½¿ç”¨éšæœºèƒŒæ™¯") }}</div>
                <div v-if="customBackground" class="secondary-hint">
                  {{ t("å·²å¯¼å…¥æœ¬åœ°å›¾ç‰‡ï¼Œå°†ä¼˜å…ˆä½¿ç”¨æœ¬åœ°èƒŒæ™¯ã€‚") }}
                </div>
                <div v-if="customBackgroundError" class="secondary-hint secondary-warning">
                  {{ customBackgroundError }}
                </div>
              </div>
              <div class="secondary-item">
                <div class="secondary-label">{{ t("æ–°æ‰‹æ•™ç¨‹") }}</div>
                <button class="ghost-button" @click="startTutorial(true)">{{ t("å†æ¬¡ä½“éªŒ") }}</button>
              </div>
              <div class="secondary-item secondary-desc">
                <label class="notice-skip">
                  <input type="checkbox" v-model="tutorialSkipAll" />
                  {{ t("ä¸å†è‡ªåŠ¨å¼¹å‡ºå½“å‰ç‰ˆæœ¬æ–°æ‰‹æ•™ç¨‹") }}
                </label>
              </div>
            </div>
          </div>
        </div>
        <nav class="main-nav hero-nav">
          <button 
            class="nav-item" 
            :class="{ active: currentView === 'planner' }" 
            @click="setView('planner')"
          >
            {{ t("åŸºè´¨è§„åˆ’") }}
          </button>
          <button 
            class="nav-item" 
            :class="{ active: currentView === 'strategy' }" 
            @click="setView('strategy')"
          >
            {{ t("è§’è‰²æ”»ç•¥") }}
          </button>
          <button 
            class="nav-item" 
            :class="{ active: currentView === 'reforging' }" 
            @click="setView('reforging')"
          >
            {{ t("è£…å¤‡ç²¾é”»") }}
          </button>
        </nav>
      </header>
      <div v-if="showAiNotice" class="ai-notice">
        <span class="ai-chip">AI</span>
        <span>{{ t("å½“å‰è¯­è¨€å†…å®¹ç”± AI ç¿»è¯‘ï¼Œå¯èƒ½å­˜åœ¨ä¸å‡†ç¡®ã€‚å¦‚å‘ç°é”™è¯¯ï¼Œè¯·å‰å¾€ GitHub åé¦ˆã€‚") }}</span>
      </div>
      <div v-if="lowGpuEnabled" class="perf-status">
        <div class="perf-status-text">
          {{ t("ä½GPUæ¨¡å¼å·²å¼€å¯") }}{{ perfPreference === "auto" ? t("ï¼ˆè‡ªåŠ¨ï¼‰") : t("ï¼ˆæ‰‹åŠ¨ï¼‰") }}
        </div>
        <button class="ghost-button" @click.stop="showSecondaryMenu = true">
          {{ t("æ›´å¤šè®¾ç½®") }}
        </button>
      </div>
      <div v-if="showPerfNotice" class="perf-notice">
        <div class="perf-notice-text">
          {{ t("æ£€æµ‹åˆ°å½“å‰æ¸²æŸ“æ€§èƒ½è¾ƒä½ï¼Œå·²è‡ªåŠ¨åˆ‡æ¢åˆ°ä½GPUæ¨¡å¼ä»¥æå‡æ»šåŠ¨æµç•…åº¦ï¼ˆå¯åœ¨â€œæ›´å¤šè®¾ç½®â€è°ƒæ•´ï¼‰ã€‚") }}
        </div>
        <div class="perf-notice-actions">
          <button class="ghost-button" @click="setPerfMode('standard')">{{ t("æ¢å¤æ•ˆæœ") }}</button>
          <button class="about-button perf-keep" @click="setPerfMode('low')">{{ t("ä¿æŒä½GPU") }}</button>
        </div>
      </div>

      <main class="layout">
        <transition name="view-switch" mode="out-in">
          <div v-if="currentView === 'planner'" key="planner" class="view-shell planner-shell">
        <div class="mobile-tabs">
          <button
            class="mobile-tab"
            :class="{ active: mobilePanel === 'weapons' }"
            @click="mobilePanel = 'weapons'"
          >
            {{ t("æ­¦å™¨é€‰æ‹©") }} <span class="count">{{ selectedNames.length }}</span>
          </button>
          <button
            class="mobile-tab"
            ref="tutorialPlansTab"
            :class="{
              active: mobilePanel === 'plans',
              'tutorial-highlight':
                tutorialActive &&
                tutorialStepKey === 'base-pick' &&
                isPortrait &&
                mobilePanel !== 'plans'
            }"
            @click="mobilePanel = 'plans'"
          >
            {{ t("æ–¹æ¡ˆæ¨è") }} <span class="count">{{ recommendations.length }}</span>
          </button>
        </div>
        <div class="mobile-hint">{{ t("æ‰‹æœºç«¯å¯é€šè¿‡ä¸Šæ–¹æ ‡ç­¾åˆ‡æ¢â€œæ­¦å™¨é€‰æ‹© / æ–¹æ¡ˆæ¨èâ€ã€‚") }}</div>
        <section class="panel" :class="{ 'panel-hidden': mobilePanel !== 'weapons' }">
          <div class="panel-title">
            <h2>{{ t("æ­¦å™¨é€‰æ‹©å™¨") }}</h2>
          </div>

          <div class="search-box">
            <span>ğŸ”</span>
            <input v-model="searchQuery" :placeholder="t('æœç´¢æ­¦å™¨ / å±æ€§ / è§’è‰²...')" />
          </div>

          <div class="filter-toolbar">
            <div class="filter-toolbar-main">
              <button
                class="ghost-button"
                :class="{
                  'is-active': showWeaponAttrs,
                  'tutorial-highlight': tutorialActive && tutorialStepKey === 'show-attrs',
                  'attr-hint-target': showAttrHint
                }"
                @click="toggleShowWeaponAttrs"
              >
                {{ showWeaponAttrs ? t("éšè—å±æ€§/æ’é™¤/å¤‡æ³¨ç®¡ç†") : t("æ˜¾ç¤ºå±æ€§/æ’é™¤/å¤‡æ³¨ç®¡ç†") }}
              </button>
              <button class="ghost-button" @click="showFilterPanel = !showFilterPanel">
                {{ showFilterPanel ? t("æŠ˜å å±æ€§ç­›é€‰") : t("å±•å¼€å±æ€§ç­›é€‰") }}
              </button>
            </div>
            <button
              class="ghost-button filter-toolbar-clear"
              :disabled="!hasAttributeFilters"
              @click="clearAttributeFilters"
            >
              {{ t("æ¸…ç©ºå±æ€§ç­›é€‰") }}
            </button>
          </div>
          <transition name="fade-scale">
            <div v-if="showAttrHint" class="attr-hint">
              <span class="attr-hint-text">
                {{
                  t("æç¤ºï¼šç‚¹å‡»â€œ{label}â€æŒ‰é’®ï¼Œå¯åˆ‡æ¢æ˜¾ç¤ºå±æ€§å’Œæ’é™¤åŠŸèƒ½ã€‚", {
                    label: t("æ˜¾ç¤ºå±æ€§/æ’é™¤/å¤‡æ³¨ç®¡ç†")
                  })
                }}
              </span>
              <button class="ghost-button attr-hint-dismiss" @click="dismissAttrHint">
                {{ t("çŸ¥é“äº†") }}
              </button>
            </div>
          </transition>
          <div class="filter-panel" :class="{ 'is-collapsed': !showFilterPanel }">
            <div class="filter-group">
              <div class="filter-title">{{ t("åŸºç¡€å±æ€§") }}</div>
              <div class="filter-chips">
                <button
                  v-for="value in s1Options"
                  :key="value"
                  class="filter-chip"
                  :class="{ 'is-active': filterS1.includes(value) }"
                  @click="toggleFilterValue('s1', value)"
                >
                  {{ formatS1(value) }}
                </button>
              </div>
            </div>
            <div class="filter-group">
              <div class="filter-title">{{ t("é™„åŠ å±æ€§") }}</div>
              <div class="filter-chips">
                <button
                  v-for="value in s2Options"
                  :key="value"
                  class="filter-chip"
                  :class="{ 'is-active': filterS2.includes(value) }"
                  @click="toggleFilterValue('s2', value)"
                >
                  {{ tTerm("s2", value) }}
                </button>
              </div>
            </div>
            <div class="filter-group">
              <div class="filter-title">{{ t("æŠ€èƒ½å±æ€§") }}</div>
              <div class="filter-chips">
                <button
                  v-for="option in s3OptionEntries"
                  :key="option.value"
                  class="filter-chip"
                  :class="{
                    'is-active': filterS3.includes(option.value),
                    'is-disabled': option.isEmpty,
                  }"
                  :title="option.isEmpty ? t('å½“å‰æ­¦å™¨æš‚æ— è¯¥è¯æ¡') : ''"
                  @click="option.isEmpty ? null : toggleFilterValue('s3', option.value)"
                >
                  <span>{{ tTerm("s3", option.value) }}</span>
                  <span v-if="option.isEmpty" class="chip-meta">{{ t("æš‚æ— ") }}</span>
                </button>
              </div>
              <div class="filter-hint">{{ t("ç°è‰²è¯æ¡ä»£è¡¨å½“å‰æš‚æ— æ­¦å™¨") }}</div>
            </div>
          </div>

          <div class="tag-row">
            <div class="tag-list">
              <span v-if="!selectedNames.length" class="tag tag-empty">{{ t("æœªé€‰æ‹©ä»»ä½•æ­¦å™¨") }}</span>
              <span
                v-for="weapon in selectedWeaponRows"
                :key="weapon.name"
                class="tag"
                :class="{ 'is-excluded': weapon.isExcluded }"
                :title="weapon.note ? `${t('å¤‡æ³¨ï¼š')}${weapon.note}` : ''"
              >
                {{ tTerm("weapon", weapon.name) }}
                <span v-if="weapon.isExcluded" class="tag-note">{{ t("æ’é™¤") }}</span>
                <button @click.stop="toggleWeapon(weapon, 'tag')">âœ•</button>
              </span>
            </div>
            <div class="tag-actions">
              <button
                class="ghost-button tag-select"
                @click="selectAllWeapons"
                :disabled="!filteredWeapons.length || allFilteredSelected"
              >
                {{ t("å…¨é€‰æ­¦å™¨") }}
              </button>
              <button class="ghost-button tag-clear" @click="clearSelection" :disabled="!selectedNames.length">
                {{ t("æ¸…ç©ºå·²é€‰æ­¦å™¨") }}
              </button>
            </div>
          </div>

          <div v-if="!showWeaponAttrs" class="weapon-list">
            <div
              v-for="weapon in filteredWeapons"
              :key="weapon.name"
              class="weapon-item"
              v-memo="[locale, selectedNameSet.has(weapon.name), isExcluded(weapon.name)]"
              :class="{
                'is-selected': selectedNameSet.has(weapon.name),
                'is-excluded': isExcluded(weapon.name),
                'rarity-6': weapon.rarity === 6,
                'rarity-5': weapon.rarity === 5,
              }"
              @click="toggleWeapon(weapon, 'grid')"
            >
              <div class="weapon-art">
                <img
                  v-if="hasImage(weapon)"
                  class="weapon-figure"
                  :src="weaponImageSrc(weapon)"
                  :alt="weapon.name"
                  loading="lazy"
                  decoding="async"
                />
                <span v-else class="weapon-fallback-large">{{ weapon.rarity }}â˜…</span>
              </div>
              <div v-if="weaponCharacters(weapon).length" class="weapon-avatars">
                <img
                  v-for="(character, index) in weaponCharacters(weapon)"
                  :key="`${weapon.name}-character-${index}`"
                  class="weapon-avatar"
                  :src="characterImageSrc(character)"
                  :alt="tTerm('character', character)"
                  loading="lazy"
                  decoding="async"
                  @error="handleCharacterImageError"
                />
              </div>
              <div class="weapon-band"></div>
              <div class="weapon-name">
                <div class="weapon-title">{{ tTerm("weapon", weapon.name) }}</div>
              </div>
            </div>
          </div>

          <div v-else class="weapon-attr-list">
          <div
            v-if="tutorialActive && (tutorialStepKey === 'exclude' || tutorialStepKey === 'note')"
            class="scheme-weapon-item weapon-attr-item tutorial-weapon-item"
            ref="tutorialWeaponTarget"
          >
              <div class="scheme-weapon-title">
                <div class="weapon-mini" :style="rarityBadgeStyle(tutorialWeapon.rarity, false)">
                  <span class="weapon-fallback">{{ tutorialWeapon.rarity }}â˜…</span>
                </div>
                <span v-if="weaponCharacters(tutorialWeapon).length" class="weapon-avatars">
                  <img
                    v-for="(character, index) in weaponCharacters(tutorialWeapon)"
                    :key="`${tutorialWeapon.name}-character-${index}`"
                    class="weapon-avatar"
                    :src="characterImageSrc(character)"
                    :alt="tTerm('character', character)"
                    loading="lazy"
                    decoding="async"
                    @error="handleCharacterImageError"
                  />
                </span>
                <span>{{ tutorialWeapon.name }}</span>
                <span class="rarity" :style="rarityTextStyle(tutorialWeapon.rarity)">
                  {{ tutorialWeapon.rarity }}â˜…
                </span>
                <span class="badge tutorial-badge">{{ t("æ•™å­¦ç¤ºä¾‹") }}</span>
                <span class="badge muted" v-if="tutorialExcluded">{{ t("æ’é™¤") }}</span>
                <span v-if="tutorialWeapon.short" class="weapon-short">
                  {{ tTerm("short", tutorialWeapon.short) }}
                </span>
              </div>
              <div class="scheme-weapon-attrs">
                <span class="attr-value attr-type">{{ t(tutorialWeapon.type) }}</span>
                <span class="attr-value">{{ formatS1(tutorialWeapon.s1) }}</span>
                <span class="attr-value">{{ t(tutorialWeapon.s2) }}</span>
                <span class="attr-value">{{ t(tutorialWeapon.s3) }}</span>
              </div>
              <div class="weapon-exclude-row" @click.stop>
                <button
                  class="exclude-toggle small"
                  :class="{
                    active: tutorialExcluded,
                    'tutorial-highlight': tutorialStepKey === 'exclude'
                  }"
                  @click.stop="toggleTutorialExclude"
                >
                  {{ tutorialExcluded ? t("å–æ¶ˆæ’é™¤") : t("æ ‡è®°æ’é™¤") }}
                </button>
                <input
                  class="exclude-note-input"
                  :class="{
                    'is-excluded': tutorialExcluded,
                    'tutorial-highlight': tutorialStepKey === 'note'
                  }"
                  type="text"
                  maxlength="30"
                  :placeholder="t('å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰')"
                  :value="tutorialNote"
                  @focus="markTutorialNoteTouched"
                  @input="updateTutorialNote($event.target.value)"
                />
              </div>
            </div>
            <div
              v-for="weapon in filteredWeapons"
              :key="weapon.name"
              class="scheme-weapon-item weapon-attr-item"
              v-memo="[
                locale,
                selectedNameSet.has(weapon.name),
                isExcluded(weapon.name),
                filterS1.includes(weapon.s1),
                filterS2.includes(weapon.s2),
                filterS3.includes(weapon.s3),
                getWeaponNote(weapon.name),
              ]"
              :class="{
                'is-selected': selectedNameSet.has(weapon.name),
                'is-excluded': isExcluded(weapon.name),
              }"
              @click="toggleWeapon(weapon, 'attrs')"
            >
              <div class="scheme-weapon-title">
                <div
                  class="weapon-mini"
                  :style="rarityBadgeStyle(weapon.rarity, hasImage(weapon))"
                >
                  <img
                    v-if="hasImage(weapon)"
                    :src="weaponImageSrc(weapon)"
                    :alt="weapon.name"
                    loading="lazy"
                    decoding="async"
                  />
                  <span v-else class="weapon-fallback">{{ weapon.rarity }}â˜…</span>
                </div>
                <span v-if="weaponCharacters(weapon).length" class="weapon-avatars">
                  <img
                    v-for="(character, index) in weaponCharacters(weapon)"
                    :key="`${weapon.name}-character-${index}`"
                    class="weapon-avatar"
                    :src="characterImageSrc(character)"
                    :alt="tTerm('character', character)"
                    loading="lazy"
                    decoding="async"
                    @error="handleCharacterImageError"
                  />
                </span>
                <span>{{ tTerm("weapon", weapon.name) }}</span>
                <span class="rarity" :style="rarityTextStyle(weapon.rarity)">
                  {{ weapon.rarity }}â˜…
                </span>
                <span class="badge" v-if="selectedNameSet.has(weapon.name)">{{ t("å·²é€‰") }}</span>
                <span class="badge muted" v-if="isExcluded(weapon.name)">{{ t("æ’é™¤") }}</span>
                <span v-if="weapon.short" class="weapon-short">
                  {{ tTerm("short", weapon.short) }}
                </span>
              </div>
              <div class="scheme-weapon-attrs">
                <span class="attr-value attr-type">{{ tTerm("type", weapon.type) }}</span>
                <span
                  class="attr-value"
                  :class="{ 'base-lock': filterS1.length && filterS1.includes(weapon.s1) }"
                >
                  {{ formatS1(weapon.s1) }}
                </span>
                <span
                  class="attr-value"
                  :class="{ locked: filterS2.length && filterS2.includes(weapon.s2) }"
                >
                  {{ tTerm("s2", weapon.s2) }}
                </span>
                <span
                  class="attr-value"
                  :class="{ locked: filterS3.length && filterS3.includes(weapon.s3) }"
                >
                  {{ tTerm("s3", weapon.s3) }}
                </span>
              </div>
              <div class="weapon-exclude-row" @click.stop>
                <button
                  class="exclude-toggle small"
                  :class="{ active: isExcluded(weapon.name) }"
                  @click.stop="toggleExclude(weapon)"
                >
                  {{ isExcluded(weapon.name) ? t("å–æ¶ˆæ’é™¤") : t("æ ‡è®°æ’é™¤") }}
                </button>
                <input
                  class="exclude-note-input"
                  :class="{ 'is-excluded': isExcluded(weapon.name) }"
                  type="text"
                  maxlength="30"
                  :placeholder="t('å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰')"
                  :value="getWeaponNote(weapon.name)"
                  @input="updateWeaponNote(weapon, $event.target.value)"
                />
              </div>
            </div>
          </div>
        </section>

        <section class="panel" :class="{ 'panel-hidden': mobilePanel !== 'plans' }">
          <div class="panel-title">
            <h2>{{ t("æ–¹æ¡ˆæ¨èåˆ—è¡¨") }}</h2>
            <div class="panel-actions">
              <div class="plan-config" @click.stop>
                <button
                  class="ghost-button toggle-button"
                  :class="{ 'is-active': showPlanConfig }"
                  :aria-pressed="showPlanConfig ? 'true' : 'false'"
                  @click="togglePlanConfig"
                >
                  <span
                    v-if="showPlanConfigHintDot"
                    class="plan-config-hint-dot"
                    aria-hidden="true"
                  ></span>
                  <span>{{ t("æ–¹æ¡ˆæ¨èè®¾ç½®") }}</span>
                </button>
                <div v-if="showPlanConfig" class="plan-config-panel">
                  <div class="plan-config-item">
                    <div class="secondary-label">{{ t("æ–¹æ¡ˆæ˜¾ç¤º") }}</div>
                    <button
                      class="ghost-button toggle-button switch-toggle"
                      :class="{ 'is-active': recommendationConfig.hideExcluded }"
                      :title="t('å¼€å¯åï¼Œæ’é™¤çš„æ­¦å™¨å°†ä¸ä¼šå‡ºç°åœ¨æ–¹æ¡ˆæ¨èåˆ—è¡¨ä¸­ã€‚')"
                      role="switch"
                      :aria-checked="recommendationConfig.hideExcluded ? 'true' : 'false'"
                      @click="recommendationConfig.hideExcluded = !recommendationConfig.hideExcluded"
                    >
                      <span class="switch-label">{{ t("éšè—å·²æ’é™¤æ­¦å™¨") }}</span>
                      <span class="switch-track" :class="{ on: recommendationConfig.hideExcluded }" aria-hidden="true">
                        <span class="switch-thumb"></span>
                      </span>
                    </button>
                  </div>
                  <div class="plan-config-item">
                    <div class="secondary-label">{{ t("åœ°åŒºä¼˜å…ˆçº§") }}</div>
                    <select class="secondary-select" v-model="recommendationConfig.preferredRegion1">
                      <option value="">{{ t("ä¸è®¾ç½®") }}</option>
                      <option v-for="region in regionOptions" :key="'region-1-' + region" :value="region">
                        {{ region }}
                      </option>
                    </select>
                    <div class="secondary-hint">{{ t("ä¼˜å…ˆåœ°åŒº1ï¼ˆæœ€é«˜ï¼‰") }}</div>
                    <select class="secondary-select" v-model="recommendationConfig.preferredRegion2">
                      <option value="">{{ t("ä¸è®¾ç½®") }}</option>
                      <option
                        v-for="region in regionOptions"
                        :key="'region-2-' + region"
                        :value="region"
                        :disabled="region === recommendationConfig.preferredRegion1"
                      >
                        {{ region }}
                      </option>
                    </select>
                    <div class="secondary-hint">{{ t("ä¼˜å…ˆåœ°åŒº2ï¼ˆæ¬¡é«˜ï¼‰") }}</div>
                  </div>
                  <div class="plan-config-item">
                    <div class="secondary-label">{{ t("ä¼˜å…ˆçº§å½±å“ç­–ç•¥") }}</div>
                    <select class="secondary-select" v-model="recommendationConfig.priorityMode">
                      <option
                        v-for="mode in tPlanPriorityModeOptions"
                        :key="mode.value"
                        :value="mode.value"
                      >
                        {{ mode.label }}
                      </option>
                    </select>
                    <div class="priority-mode-guide">
                      <div
                        class="secondary-hint priority-mode-desc"
                        :class="{ 'is-active': recommendationConfig.priorityMode === mode.value }"
                        v-for="mode in tPlanPriorityModeOptions"
                        :key="'mode-desc-' + mode.value"
                      >
                        <span class="priority-mode-name">{{ mode.label }}ï¼š</span>{{ mode.description }}
                      </div>
                    </div>
                  </div>
                  <div class="plan-config-item" v-if="recommendationConfig.priorityMode === 'weighted'">
                    <div class="secondary-label">{{ t("å½±å“å¼ºåº¦") }}</div>
                    <input
                      class="secondary-range"
                      type="range"
                      min="0"
                      max="100"
                      step="1"
                      v-model.number="recommendationConfig.priorityStrength"
                    />
                    <div class="secondary-hint">{{ t("å½“å‰å¼ºåº¦ï¼š") }}{{ recommendationConfig.priorityStrength }}</div>
                    <div class="secondary-hint">
                      {{ t("0~30ï¼šä»¥æ•ˆç‡ä¸ºä¸»ï¼›40~70ï¼šæ•ˆç‡ä¸åœ°åŒºå¹³è¡¡ï¼›80~100ï¼šæ˜¾è‘—ä¼˜å…ˆåœ°åŒºï¼ˆä»…â€œåŠ æƒèåˆâ€ç”Ÿæ•ˆï¼‰") }}
                    </div>
                    <div class="secondary-hint">
                      {{ t("å½±å“å¼ºåº¦ç”¨äºæ§åˆ¶â€œåœ°åŒºåŠ åˆ†â€å¯¹æ€»æ’åºçš„ä½œç”¨æ¯”ä¾‹ï¼Œæ•°å€¼è¶Šå¤§ï¼Œä¼˜å…ˆåœ°åŒºè¶Šå®¹æ˜“æ’åœ¨å‰é¢ã€‚") }}
                    </div>
                    <div class="secondary-hint">
                      {{
                        t("è¯´æ˜ï¼šå½±å“å¼ºåº¦è¶Šé«˜ï¼Œåœ°åŒºä¼˜å…ˆçº§è¶Šå®¹æ˜“å‹è¿‡æ•ˆç‡å·®å¼‚ï¼›0è¡¨ç¤ºå‡ ä¹åªæŒ‰æ•ˆç‡æ’åºï¼Œ100è¡¨ç¤ºæ›´å¼ºè°ƒä¼˜å…ˆåœ°åŒºã€‚")
                      }}
                    </div>
                    <div class="secondary-label">{{ t("åœ°åŒº2æƒé‡") }}</div>
                    <input
                      class="secondary-range"
                      type="range"
                      min="0"
                      max="100"
                      step="1"
                      v-model.number="recommendationConfig.prioritySecondaryWeight"
                    />
                    <div class="secondary-hint">
                      {{ t("å½“å‰åœ°åŒº2æƒé‡ï¼š") }}{{ recommendationConfig.prioritySecondaryWeight }}%
                    </div>
                    <div class="secondary-hint">
                      {{
                        t("è¯´æ˜ï¼šåŠ æƒèåˆä¸­ï¼Œåœ°åŒº1æƒé‡å›ºå®šä¸º100%ï¼Œåœ°åŒº2æŒ‰è¯¥æ¯”ä¾‹å‚ä¸ï¼›0%ç­‰äºåªçœ‹åœ°åŒº1ï¼Œ100%ç­‰äºåœ°åŒº1å’Œåœ°åŒº2åŒæƒã€‚")
                      }}
                    </div>
                  </div>
                </div>
              </div>
              <div class="pill">{{ t("å·²é€‰") }} {{ selectedWeapons.length }} {{ t("æŠŠ") }}</div>
              <button
                v-if="extraRecommendations.length"
                class="ghost-button"
                @click="showAllSchemes = !showAllSchemes"
              >
                {{
                  showAllSchemes
                    ? t("æ”¶èµ·å…¶ä»–æ–¹æ¡ˆ")
                    : t("å±•å¼€å…¶ä»–æ–¹æ¡ˆï¼ˆ{count}ï¼‰", { count: extraRecommendations.length })
                }}
              </button>
            </div>
          </div>

          <div v-if="!selectedWeapons.length" class="empty">
            {{ t("è¯·é€‰æ‹©è‡³å°‘ä¸€æŠŠæ­¦å™¨ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æ¨èå¯å…±åˆ·çš„å‰¯æœ¬æ–¹æ¡ˆã€‚") }}
          </div>

          <div v-else-if="!recommendations.length" class="recommendations">
            <div class="card">
              <div class="card-header">
                <div>
                  <div class="card-title">{{ t("å½“å‰ç»„åˆæ— å¯ç”¨æ–¹æ¡ˆ") }}</div>
                  <div class="hint">{{ t("é™„åŠ /æŠ€èƒ½å±æ€§æ— æ³•ç»Ÿä¸€é”å®šï¼Œæˆ–å‰¯æœ¬æ± ä¸è¦†ç›–æ‰€éœ€è¯æ¡ã€‚") }}</div>
                </div>
                <div class="strategy-row">
                  <span class="pill warn">{{ t("è¯·æ‹†åˆ†æ‰¹æ¬¡åˆ·å–") }}</span>
                </div>
              </div>

              <div class="lock-summary" v-if="fallbackPlan">
                <div class="lock-title">{{ t("é”å®šæ–¹æ¡ˆï¼ˆä»…æ˜¾ç¤ºå†²çªæç¤ºï¼‰") }}</div>
                <div class="lock-items">
                  <span class="lock-chip" :class="{ warn: fallbackPlan.baseOverflow }">
                    {{ fallbackPlan.baseOverflow ? t("åŸºç¡€å±æ€§å†²çª") : t("åŸºç¡€å±æ€§") }}ï¼š
                    {{
                      (fallbackPlan.baseOverflow ? fallbackPlan.baseAllLabels : fallbackPlan.basePickLabels).join(
                        " / "
                      )
                    }}
                  </span>
                  <span class="lock-chip warn" v-if="fallbackPlan.s2Conflict">
                    {{ t("é™„åŠ å±æ€§å†²çªï¼ˆæ— æ³•ç»Ÿä¸€é”å®šï¼‰") }}
                  </span>
                  <span class="lock-chip warn" v-if="fallbackPlan.s3Conflict">
                    {{ t("æŠ€èƒ½å±æ€§å†²çªï¼ˆæ— æ³•ç»Ÿä¸€é”å®šï¼‰") }}
                  </span>
                </div>
              </div>

              <div class="hint">{{ t("å·²é€‰æ­¦å™¨ï¼ˆå†²çªé¡¹æ ‡çº¢ï¼‰") }}</div>
              <div class="scheme-weapon-list">
                <div
                  v-for="weapon in fallbackPlan.weaponRows"
                  :key="weapon.name"
                  class="scheme-weapon-item is-selected"
                  v-memo="[
                    locale,
                    weapon.baseLocked,
                    weapon.baseConflict,
                    fallbackPlan.s2Conflict,
                    fallbackPlan.s3Conflict,
                    isExcluded(weapon.name),
                    getWeaponNote(weapon.name),
                  ]"
                >
                  <div class="scheme-weapon-title">
                    <span v-if="weaponCharacters(weapon).length" class="weapon-avatars">
                      <img
                        v-for="(character, index) in weaponCharacters(weapon)"
                        :key="`${weapon.name}-fallback-character-${index}`"
                        class="weapon-avatar"
                        :src="characterImageSrc(character)"
                        :alt="tTerm('character', character)"
                        loading="lazy"
                        decoding="async"
                        @error="handleCharacterImageError"
                      />
                    </span>
                    <span>{{ tTerm("weapon", weapon.name) }}</span>
                    <span class="rarity" :style="rarityTextStyle(weapon.rarity)">
                      {{ weapon.rarity }}â˜…
                    </span>
                    <span class="badge">{{ t("å·²é€‰") }}</span>
                    <span v-if="weapon.short" class="weapon-short">
                      {{ tTerm("short", weapon.short) }}
                    </span>
                  </div>
                  <div class="scheme-weapon-attrs">
                    <span class="attr-value attr-type">
                      <span class="attr-label">{{ t("ç±»å‹") }}ï¼š</span>{{ tTerm("type", weapon.type) }}
                    </span>
                    <span
                      class="attr-value"
                      :class="{
                        'base-lock': weapon.baseLocked,
                        conflict: weapon.baseConflict,
                      }"
                    >
                      <span class="attr-label">{{ t("åŸºç¡€å±æ€§") }}ï¼š</span>{{ formatS1(weapon.s1) }}
                    </span>
                    <span class="attr-value" :class="{ conflict: fallbackPlan.s2Conflict }">
                      <span class="attr-label">{{ t("é™„åŠ å±æ€§") }}ï¼š</span>{{ tTerm("s2", weapon.s2) }}
                    </span>
                    <span class="attr-value" :class="{ conflict: fallbackPlan.s3Conflict }">
                      <span class="attr-label">{{ t("æŠ€èƒ½å±æ€§") }}ï¼š</span>{{ tTerm("s3", weapon.s3) }}
                    </span>
                  </div>
                  <div class="weapon-exclude-row" @click.stop>
                    <button
                      class="exclude-toggle small"
                      :class="{ active: isExcluded(weapon.name) }"
                      @click.stop="toggleExclude(weapon)"
                    >
                      {{ isExcluded(weapon.name) ? t("å–æ¶ˆæ’é™¤") : t("æ ‡è®°æ’é™¤") }}
                    </button>
                    <input
                      class="exclude-note-input"
                      :class="{ 'is-excluded': isExcluded(weapon.name) }"
                      type="text"
                      maxlength="30"
                      :placeholder="t('å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰')"
                      :value="getWeaponNote(weapon.name)"
                      @input="updateWeaponNote(weapon, $event.target.value)"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div v-else class="recommendations">
            <div v-if="coverageSummary && coverageSummary.hasGap" class="card">
              <div class="card-header">
                <div>
                  <div class="card-title">{{ t("å½“å‰ç»„åˆéœ€è¦åˆ†æ‰¹åˆ·å–") }}</div>
                  <div class="hint">
                    {{ t("è¯¥ç»„åˆæ— æ³•åœ¨åŒä¸€æ‰¹æ¬¡å®Œæˆï¼Œå·²ç”Ÿæˆ {count} å¥—æ–¹æ¡ˆè¦†ç›–å…¨éƒ¨å·²é€‰æ­¦å™¨ï¼Œå¹¶æŒ‰æ•ˆç‡ä¼˜å…ˆæ’åºã€‚", {
                      count: recommendations.length,
                    }) }}
                    <span class="hint-accent">
                      {{ t("å½“å‰å±•ç¤º {count} å¥—æ–¹æ¡ˆå·²æ»¡è¶³å…¨éƒ¨å·²é€‰æ­¦å™¨åˆ·å–è¦æ±‚", {
                        count: displayRecommendations.length,
                      }) }}
                    </span>
                    {{ t("è¯·åœ¨ä¸‹æ–¹æŸ¥çœ‹ã€‚å¦‚éœ€æŸ¥çœ‹æ›´å¤šæ–¹æ¡ˆè¯·ç‚¹å‡»å±•å¼€å…¶ä»–æ–¹æ¡ˆæŒ‰é’®ã€‚") }}
                  </div>
                </div>
              </div>
            </div>
            <template v-for="(card, index) in displayRecommendations" :key="card.schemeKey">
              <div v-if="index === displayDividerIndex" class="scheme-divider">
                <span>{{ t("å…¶ä»–æ–¹æ¡ˆ") }}</span>
              </div>
              <div
                class="card"
                :class="{
                  'tutorial-scheme-highlight':
                    tutorialActive &&
                    tutorialStepKey === 'base-pick' &&
                    tutorialTargetSchemeKey &&
                    card.schemeKey === tutorialTargetSchemeKey,
                }"
                :ref="
                  tutorialActive &&
                  tutorialStepKey === 'base-pick' &&
                  tutorialTargetSchemeKey &&
                  card.schemeKey === tutorialTargetSchemeKey
                    ? 'tutorialSchemeTarget'
                    : null
                "
              >
              <div class="card-header">
                <div>
                  <div class="card-title">{{ tTerm("dungeon", card.dungeon.name) }}</div>
                  <div class="hint" v-if="card.displaySelectedMatchCount === selectedWeapons.length">
                    {{ t("é™„åŠ å±æ€§æ±  / æŠ€èƒ½å±æ€§æ±  å‡å·²æ»¡è¶³æ‰€é€‰æ­¦å™¨éœ€æ±‚") }}
                  </div>
                  <div class="hint" v-else>
                    {{
                      t("å·²è¦†ç›– {match} / {total} æŠŠå·²é€‰æ­¦å™¨ï¼Œå‰©ä½™éœ€æ‹†åˆ†åˆ·å–ã€‚", {
                        match: card.displaySelectedMatchCount,
                        total: selectedWeapons.length,
                      })
                    }}
                  </div>
                  <details
                    v-if="card.displaySelectedMissingNames.length && !card.baseOverflow"
                    class="missing-details"
                    :open="selectedWeapons.length > 1"
                  >
                    <summary>
                      {{ t("æœªè¦†ç›–") }} {{ card.displaySelectedMissingNames.length }} {{ t("æŠŠ") }}ï¼ˆ{{
                        t("åŸºç¡€å±æ€§")
                      }}ï¼‰
                      </summary>
                      <div class="missing-tags">
                        <span
                          v-for="name in card.displaySelectedMissingNames"
                        :key="name"
                        class="missing-tag"
                      >
                        {{ tTerm("weapon", name) }}
                      </span>
                    </div>
                  </details>
                </div>
                <div class="strategy-row">
                  <span class="pill wide">
                    {{
                      t("å¯åŒæ—¶åˆ·æ­¦å™¨ï¼š{count} æŠŠï¼ˆè¦†ç›–å·²é€‰ {match} æŠŠï¼‰", {
                        count: card.displayWeaponCount,
                        match: card.displaySelectedMatchCount,
                      })
                    }}
                  </span>
                  <span class="pill" v-if="card.maxWeaponCount !== card.displayWeaponCount">
                    {{ t("æœ€å¤šå¯åˆ·ï¼š{count} æŠŠ", { count: card.maxWeaponCount }) }}
                  </span>
                  <span class="pill warn" v-if="card.displaySelectedMissingNames.length && !card.baseOverflow">
                    {{
                      t("æœªè¦†ç›– {count}", { count: card.displaySelectedMissingNames.length })
                    }}
                  </span>
                  <span
                    class="pill warn"
                    v-if="card.conflictSelected && card.conflictSelected.length"
                  >
                    {{ t("å†²çª {count}", { count: card.conflictSelected.length }) }}
                  </span>
                </div>
              </div>
              <div class="lock-summary">
                <div class="lock-title">{{ t("é”å®šæ–¹æ¡ˆ") }}</div>
                <div class="lock-items">
                  <span
                    class="lock-chip"
                    :class="{ warn: card.manualPickNeeded || card.manualPickOverflow }"
                  >
                    {{ t("åŸºç¡€å±æ€§") }}ï¼š{{
                      card.basePickLabels
                        .map((label) =>
                          label === "è¯·æ‰‹åŠ¨é€‰æ‹©" || label === "ä»»æ„å±æ€§" ? t(label) : formatS1(label)
                        )
                        .join(" / ")
                    }}
                  </span>
                  <span class="lock-chip attr">{{
                    t("é”å®š{label}ï¼š{value}", {
                      label: t(card.lockLabel),
                      value: tTerm(card.lockType, card.lockValue),
                    })
                  }}</span>
                </div>
                <div
                  class="hint"
                  v-if="card.baseOverflow"
                  :class="{ 'status-warn': card.manualPickOverflow }"
                >
                  <template v-if="card.manualPickOverflow">
                    <span class="hint-line">{{ t("å·²é€‰æ‹©è¶…è¿‡ä¸‰ç§åŸºç¡€å±æ€§ï¼Œè¯·æ”¾å¼ƒä¸€ç§å±æ€§ã€‚") }}</span>
                    <span class="hint-line hint-accent">
                      {{
                        t("è¯·åœ¨ä¸‹æ–¹é»„è‰²é«˜äº®çš„æ­¦å™¨ä¸­ç‚¹å‡»æ­¦å™¨é€‰æ‹©ä½ æƒ³è¦æ”¾å¼ƒçš„åŸºç¡€å±æ€§ï¼ˆè¿˜éœ€æ”¾å¼ƒ {count} ä¸ªï¼‰", {
                          count: card.manualPickOverflowCount,
                        })
                      }}
                    </span>
                  </template>
                  <template v-else-if="card.manualPickNeeded">
                    <span class="hint-line">{{ t("åŸºç¡€å±æ€§è¶…è¿‡ä¸‰é€‰ã€‚") }}</span>
                    <span class="hint-line hint-accent">
                      {{
                        t("è¯·åœ¨ä¸‹æ–¹é»„è‰²é«˜äº®çš„æ­¦å™¨ä¸­ç‚¹å‡»æ­¦å™¨é€‰æ‹©ä½ æƒ³è¦åˆ·å–çš„åŸºç¡€å±æ€§ï¼ˆè¿˜éœ€é€‰æ‹© {count} ä¸ªï¼‰", {
                          count: card.manualPickNeeded,
                        })
                      }}
                    </span>
                  </template>
                  <template v-else>
                    <span class="hint-line">{{ t("åŸºç¡€å±æ€§å·²é”å®šï¼Œå¯åŒæ—¶åˆ·èŒƒå›´å·²æ›´æ–°ã€‚") }}</span>
                    <span class="hint-line hint-accent">{{ t("å¯ç‚¹å‡»æ­¦å™¨æ¥é€‰ä¸­/å–æ¶ˆåŸºç¡€å±æ€§ã€‚") }}</span>
                  </template>
                </div>
              </div>

              <div v-if="card.conflictSelected && card.conflictSelected.length" class="conflict-section">
                <button class="ghost-button" @click="toggleConflictOpen(card.schemeKey)">
                  {{
                    isConflictOpen(card.schemeKey)
                      ? t("ç‚¹å‡»æ”¶èµ·å†²çªå·²é€‰æ­¦å™¨")
                      : t("ç‚¹å‡»å±•å¼€å†²çªå·²é€‰æ­¦å™¨ï¼ˆ{count}ï¼‰", { count: card.conflictSelected.length })
                  }}
                </button>
                <transition name="collapse">
                  <div
                    v-if="isConflictOpen(card.schemeKey)"
                    class="scheme-weapon-list conflict-list"
                  >
                    <div
                      v-for="weapon in card.conflictSelected"
                      :key="weapon.name"
                      class="scheme-weapon-item is-selected is-disabled"
                      v-memo="[
                        locale,
                        weapon.conflictS2,
                        weapon.conflictS3,
                        weapon.conflictReason,
                        isExcluded(weapon.name),
                        weapon.note,
                      ]"
                    >
                      <div class="scheme-weapon-title">
                        <div
                          class="weapon-mini"
                          :style="rarityBadgeStyle(weapon.rarity, hasImage(weapon))"
                        >
                          <img
                            v-if="hasImage(weapon)"
                            :src="weaponImageSrc(weapon)"
                            :alt="weapon.name"
                            loading="lazy"
                            decoding="async"
                          />
                          <span v-else class="weapon-fallback">{{ weapon.rarity }}â˜…</span>
                        </div>
                        <span v-if="weaponCharacters(weapon).length" class="weapon-avatars">
                          <img
                            v-for="(character, index) in weaponCharacters(weapon)"
                            :key="`${weapon.name}-conflict-character-${index}`"
                            class="weapon-avatar"
                            :src="characterImageSrc(character)"
                            :alt="tTerm('character', character)"
                            loading="lazy"
                            decoding="async"
                            @error="handleCharacterImageError"
                          />
                        </span>
                        <span>{{ tTerm("weapon", weapon.name) }}</span>
                        <span class="rarity" :style="rarityTextStyle(weapon.rarity)">
                          {{ weapon.rarity }}â˜…
                        </span>
                        <span class="badge warn">{{ t("å†²çª") }}</span>
                        <span v-if="weapon.short" class="weapon-short">
                          {{ tTerm("short", weapon.short) }}
                        </span>
                      </div>
                      <div class="scheme-weapon-attrs">
                        <span class="attr-value attr-type">
                          <span class="attr-label">{{ t("ç±»å‹") }}ï¼š</span>{{ tTerm("type", weapon.type) }}
                        </span>
                        <span class="attr-value">
                          <span class="attr-label">{{ t("åŸºç¡€å±æ€§") }}ï¼š</span>{{ formatS1(weapon.s1) }}
                        </span>
                        <span class="attr-value" :class="{ conflict: weapon.conflictS2 }">
                          <span class="attr-label">{{ t("é™„åŠ å±æ€§") }}ï¼š</span>{{ tTerm("s2", weapon.s2) }}
                        </span>
                        <span class="attr-value" :class="{ conflict: weapon.conflictS3 }">
                          <span class="attr-label">{{ t("æŠ€èƒ½å±æ€§") }}ï¼š</span>{{ tTerm("s3", weapon.s3) }}
                        </span>
                      </div>
                      <div class="conflict-reason">
                        {{ t("å†²çªåŸå› ï¼š{reason}", { reason: weapon.conflictReason }) }}
                      </div>
                      <div class="weapon-exclude-row" @click.stop>
                        <button
                          class="exclude-toggle small"
                          :class="{ active: isExcluded(weapon.name) }"
                          @click.stop="toggleExclude(weapon)"
                        >
                          {{ isExcluded(weapon.name) ? t("å–æ¶ˆæ’é™¤") : t("æ ‡è®°æ’é™¤") }}
                        </button>
                        <input
                          class="exclude-note-input"
                          :class="{ 'is-excluded': isExcluded(weapon.name) }"
                          type="text"
                          maxlength="30"
                          :placeholder="t('å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰')"
                          :value="getWeaponNote(weapon.name)"
                          @input="updateWeaponNote(weapon, $event.target.value)"
                        />
                      </div>
                    </div>
                  </div>
                </transition>
              </div>

              <div class="scheme-weapon-list">
                <div
                  v-for="weapon in card.weaponRows"
                  :key="weapon.name"
                  class="scheme-weapon-item"
                  v-memo="[
                    locale,
                    weapon.isSelected,
                    weapon.isExcluded,
                    weapon.baseDim,
                    weapon.baseConflict,
                    weapon.baseLocked,
                    weapon.note,
                    card.baseOverflow,
                    card.lockType,
                    tutorialActive,
                    tutorialStepKey,
                    tutorialTargetSchemeKey,
                    card.schemeKey,
                    isTutorialGuideWeapon(weapon.name),
                  ]"
                  :class="{
                    'is-selected': weapon.isSelected,
                    'base-selectable': card.baseOverflow,
                    'base-choice':
                      card.baseOverflow &&
                      !weapon.isExcluded &&
                      ((card.manualPickOverflow && weapon.baseLocked) ||
                        (!card.manualPickOverflow && card.manualPickNeeded && !weapon.baseLocked)),
                    'is-dim': weapon.baseDim || weapon.isExcluded,
                    'is-excluded': weapon.isExcluded,
                    'tutorial-highlight':
                      tutorialActive &&
                      tutorialStepKey === 'base-pick' &&
                      tutorialTargetSchemeKey &&
                      card.schemeKey === tutorialTargetSchemeKey &&
                      isTutorialGuideWeapon(weapon.name),
                  }"
                  :title="card.baseOverflow ? t('ç‚¹å‡»é€‰æ‹©åŸºç¡€å±æ€§') : ''"
                  @click="toggleSchemeBasePick(card, weapon)"
                >
                  <div class="scheme-weapon-title">
                    <div class="weapon-mini" :style="rarityBadgeStyle(weapon.rarity, hasImage(weapon))">
                      <img
                        v-if="hasImage(weapon)"
                        :src="weaponImageSrc(weapon)"
                        :alt="weapon.name"
                        loading="lazy"
                        decoding="async"
                      />
                      <span v-else class="weapon-fallback">{{ weapon.rarity }}â˜…</span>
                    </div>
                    <span v-if="weaponCharacters(weapon).length" class="weapon-avatars">
                      <img
                        v-for="(character, index) in weaponCharacters(weapon)"
                        :key="`${weapon.name}-scheme-character-${index}`"
                        class="weapon-avatar"
                        :src="characterImageSrc(character)"
                        :alt="tTerm('character', character)"
                        loading="lazy"
                        decoding="async"
                        @error="handleCharacterImageError"
                      />
                    </span>
                    <span>{{ tTerm("weapon", weapon.name) }}</span>
                    <span class="rarity" :style="rarityTextStyle(weapon.rarity)">
                      {{ weapon.rarity }}â˜…
                    </span>
                    <span v-if="weapon.isSelected" class="badge">{{ t("å·²é€‰") }}</span>
                    <span v-if="weapon.isExcluded" class="badge muted">{{ t("æ’é™¤") }}</span>
                    <span v-if="weapon.short" class="weapon-short">
                      {{ tTerm("short", weapon.short) }}
                    </span>
                  </div>
                  <div class="scheme-weapon-attrs">
                    <span class="attr-value attr-type">
                      <span class="attr-label">{{ t("ç±»å‹") }}ï¼š</span>{{ tTerm("type", weapon.type) }}
                    </span>
                    <span
                      class="attr-value"
                      :class="{ 'base-lock': weapon.baseLocked, conflict: weapon.baseConflict }"
                    >
                      <span class="attr-label">{{ t("åŸºç¡€å±æ€§") }}ï¼š</span>{{ formatS1(weapon.s1) }}
                    </span>
                    <span class="attr-value" :class="{ locked: card.lockType === 's2' }">
                      <span class="attr-label">{{ t("é™„åŠ å±æ€§") }}ï¼š</span>{{ tTerm("s2", weapon.s2) }}
                    </span>
                    <span class="attr-value" :class="{ locked: card.lockType === 's3' }">
                      <span class="attr-label">{{ t("æŠ€èƒ½å±æ€§") }}ï¼š</span>{{ tTerm("s3", weapon.s3) }}
                    </span>
                  </div>
                  <div class="weapon-exclude-row" @click.stop>
                    <button
                      class="exclude-toggle small"
                      :class="{ active: weapon.isExcluded }"
                      @click.stop="toggleExclude(weapon)"
                    >
                      {{ weapon.isExcluded ? t("å–æ¶ˆæ’é™¤") : t("æ ‡è®°æ’é™¤") }}
                    </button>
                    <input
                      class="exclude-note-input"
                      :class="{ 'is-excluded': weapon.isExcluded }"
                      type="text"
                      maxlength="30"
                      :placeholder="t('å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰')"
                      :value="getWeaponNote(weapon.name)"
                      @input="updateWeaponNote(weapon, $event.target.value)"
                    />
                  </div>
                </div>
              </div>

              </div>
            </template>
            <div class="expand-row" v-if="extraRecommendations.length">
              <button class="ghost-button" @click="showAllSchemes = !showAllSchemes">
                {{
                  showAllSchemes
                    ? t("æ”¶èµ·å…¶ä»–æ–¹æ¡ˆ")
                    : t("å±•å¼€å…¶ä»–æ–¹æ¡ˆï¼ˆ{count}ï¼‰", { count: extraRecommendations.length })
                }}
              </button>
            </div>
          </div>
        </section>
          </div>

          <div v-else-if="currentView === 'strategy'" key="strategy" class="view-shell strategy-view">
            <div class="strategy-notice">
              {{ t("æ”»ç•¥å°šæœªå®Œæˆï¼Œå†…å®¹æŒç»­æ›´æ–°ä¸­ã€‚") }}
            </div>
            <transition name="guide-switch" mode="out-in" @before-leave="guideBeforeLeave" @enter="guideEnter">
              <div v-if="!selectedCharacterId" key="guide-list" class="character-list">
             <div class="panel-title">
               <h2>{{ t("è§’è‰²åˆ—è¡¨") }}</h2>
             </div>
             <div class="character-grid">
               <div 
                 v-for="char in characters" 
                 :key="char.id" 
                 class="character-card"
                 @click="selectCharacter(char.id)"
               >
                 <div class="character-avatar">
                   <img :src="char.avatar" :alt="char.name" loading="lazy" />
                 </div>
                 <div class="character-info">
                   <div class="character-name">{{ char.name }}</div>
                   <div class="character-meta">
                     <span class="rarity">{{ char.rarity }}â˜…</span>
                     <span class="element">{{ char.element }}</span>
                   </div>
                 </div>
               </div>
             </div>
          </div>
          <div v-else key="guide-detail" class="character-detail">
            <div class="detail-content" v-if="currentCharacter">
              <div class="character-hero">
                <div class="hero-left">
                  <button class="ghost-button back-button hero-back" @click="backToCharacterList">
                    â† {{ t("è¿”å›åˆ—è¡¨") }}
                  </button>
                  <div class="hero-identity">
                    <img :src="currentCharacter.avatar" :alt="currentCharacter.name" class="detail-avatar hero-avatar" />
                    <div class="hero-title">
                      <div class="hero-name-row">
                        <h1>{{ currentCharacter.name }}</h1>
                      </div>
                      <div class="hero-stars">
                        <span v-for="i in (currentCharacter.rarity || 0)" :key="i">â˜…</span>
                      </div>
                    </div>
                  </div>

                  <div class="hero-meta-row">
                    <div class="hero-meta-pair">
                      <span class="meta-label">{{ t("æ­¦å™¨") }}</span>
                      <span class="meta-value">{{ currentCharacter.weaponType || "-" }}</span>
                    </div>
                    <div class="hero-meta-pair">
                      <span class="meta-label">{{ t("å…ƒç´ ") }}</span>
                      <span class="meta-value">{{ currentCharacter.element || "-" }}</span>
                    </div>
                    <div class="hero-meta-pair">
                      <span class="meta-label">{{ t("ä¸»èƒ½åŠ›") }}</span>
                      <span class="meta-value">{{ currentCharacter.mainAbility || "-" }}</span>
                    </div>
                    <div class="hero-meta-pair">
                      <span class="meta-label">{{ t("å‰¯èƒ½åŠ›") }}</span>
                      <span class="meta-value">{{ currentCharacter.subAbility || "-" }}</span>
                    </div>
                    <div class="hero-meta-pair">
                      <span class="meta-label">{{ t("èŒä¸š") }}</span>
                      <span class="meta-value">{{ currentCharacter.profession || currentCharacter.role || "-" }}</span>
                    </div>
                  </div>
                </div>
                <div class="hero-right">
                  <div class="character-card-frame">
                    <img
                      :src="characterCardSrc(currentCharacter)"
                      :alt="currentCharacter.name"
                      class="character-card-image"
                      loading="lazy"
                      decoding="async"
                      @error="handleCharacterCardError"
                    />
                  </div>
                </div>
              </div>

              <div class="detail-tabs detail-tabs-main">
                <button
                  class="detail-tab"
                  :class="{ active: strategyCategory === 'info' }"
                  @click="setStrategyCategory('info')"
                >
                  {{ t("å¹²å‘˜ä¿¡æ¯") }}
                </button>
                <button
                  class="detail-tab"
                  :class="{ active: strategyCategory === 'guide' }"
                  @click="setStrategyCategory('guide')"
                >
                  {{ t("å¹²å‘˜æ”»ç•¥") }}
                </button>
              </div>

              <div class="detail-tabs detail-tabs-sub">
                <div class="detail-sub-header">
                  <span class="detail-sub-label">{{ t("å½“å‰æ ç›®") }}</span>
                  <span class="detail-sub-title">
                    {{ strategyCategory === 'guide' ? t("å¹²å‘˜æ”»ç•¥") : t("å¹²å‘˜ä¿¡æ¯") }}
                  </span>
                </div>
                <div class="detail-sub-tabs">
                  <button
                    v-if="strategyCategory === 'info'"
                    class="detail-tab"
                    :class="{ active: strategyTab === 'base' }"
                    @click="setStrategyTab('base')"
                  >
                    {{ t("åŸºç¡€å±æ€§") }}
                  </button>
                  <button
                    v-if="strategyCategory === 'info'"
                    class="detail-tab"
                    :class="{ active: strategyTab === 'skillsTalents' }"
                    @click="setStrategyTab('skillsTalents')"
                  >
                    {{ t("æŠ€èƒ½å¤©èµ‹") }}
                  </button>
                  <button
                    v-if="strategyCategory === 'info'"
                    class="detail-tab"
                    :class="{ active: strategyTab === 'potentials' }"
                    @click="setStrategyTab('potentials')"
                  >
                    {{ t("å¹²å‘˜æ½œèƒ½") }}
                  </button>
                  <button
                    v-if="strategyCategory === 'guide'"
                    class="detail-tab"
                    :class="{ active: strategyTab === 'analysis' }"
                    @click="setStrategyTab('analysis')"
                  >
                    {{ t("å¹²å‘˜è§£æ") }}
                  </button>
                  <button
                    v-if="strategyCategory === 'guide'"
                    class="detail-tab"
                    :class="{ active: strategyTab === 'team' }"
                    @click="setStrategyTab('team')"
                  >
                    {{ t("é…é˜Ÿæ€è·¯") }}
                  </button>
                  <button
                    v-if="strategyCategory === 'guide'"
                    class="detail-tab"
                    :class="{ active: strategyTab === 'operation' }"
                    @click="setStrategyTab('operation')"
                  >
                    {{ t("æ‰‹æ³•æ•™å­¦") }}
                  </button>
                </div>
              </div>

              <div class="detail-tab-panels">
                <div v-show="strategyCategory === 'info' && strategyTab === 'base'" class="detail-panel">
                  <div class="detail-section">
                    <h3>{{ t("åŸºç¡€å±æ€§") }}</h3>
                    <div class="stat-grid">
                      <div class="stat-item">
                        <div class="stat-label">{{ t("åŠ›é‡") }}</div>
                        <div class="stat-value">{{ (currentCharacter.stats && currentCharacter.stats.strength) || "-" }}</div>
                      </div>
                      <div class="stat-item">
                        <div class="stat-label">{{ t("æ•æ·") }}</div>
                        <div class="stat-value">{{ (currentCharacter.stats && currentCharacter.stats.agility) || "-" }}</div>
                      </div>
                      <div class="stat-item">
                        <div class="stat-label">{{ t("æ™ºè¯†") }}</div>
                        <div class="stat-value">{{ (currentCharacter.stats && currentCharacter.stats.intellect) || "-" }}</div>
                      </div>
                      <div class="stat-item">
                        <div class="stat-label">{{ t("æ„å¿—") }}</div>
                        <div class="stat-value">{{ (currentCharacter.stats && currentCharacter.stats.will) || "-" }}</div>
                      </div>
                      <div class="stat-item">
                        <div class="stat-label">{{ t("æ”»å‡»åŠ›") }}</div>
                        <div class="stat-value">{{ (currentCharacter.stats && currentCharacter.stats.attack) || "-" }}</div>
                      </div>
                      <div class="stat-item">
                        <div class="stat-label">{{ t("è¡€é‡") }}</div>
                        <div class="stat-value">{{ (currentCharacter.stats && currentCharacter.stats.hp) || "-" }}</div>
                      </div>
                    </div>
                  </div>

                  <div class="detail-section">
                    <h3>{{ t("ç²¾è‹±åŒ–ææ–™") }}</h3>
                    <div class="materials-list">
                      <div
                        v-for="level in ['elite1', 'elite2', 'elite3', 'elite4']"
                        :key="level"
                        class="material-row"
                      >
                        <div class="material-level">{{ t("ç²¾è‹±åŒ–") }} {{ level.replace('elite', '') }}</div>
                        <div class="material-items">
                          <template
                            v-if="currentCharacter.materials && currentCharacter.materials[level] && currentCharacter.materials[level].length"
                          >
                            <span
                              v-for="(mat, idx) in currentCharacter.materials[level]"
                              :key="idx"
                              class="material-tag"
                            >
                              {{ mat }}
                            </span>
                          </template>
                          <span v-else class="material-tag is-empty">-</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div v-show="strategyCategory === 'info' && strategyTab === 'skillsTalents'" class="detail-panel">
                  <div class="detail-section">
                    <h3>{{ t("æŠ€èƒ½") }}</h3>
                    <div class="skills-list">
                      <div v-for="skill in currentCharacter.skills" :key="skill.name" class="skill-item">
                        <div class="skill-header">
                          <img v-if="skill.icon" :src="skill.icon" class="skill-icon" alt="" />
                          <span class="skill-name">{{ skill.name }}</span>
                        </div>
                        <p>{{ skill.description }}</p>
                        <div v-if="getSkillTables(skill).length" class="skill-data">
                          <details>
                            <summary class="skill-data-summary">{{ t("æŠ€èƒ½æ•°æ®") }}</summary>
                            <div class="skill-data-content">
                              <div v-for="(table, tIdx) in getSkillTables(skill)" :key="tIdx" class="skill-data-table">
                                <div class="skill-data-scroll">
                                  <table class="skill-data-grid">
                                    <thead>
                                      <tr>
                                        <th class="skill-data-name">{{ t("æ•°æ®é¡¹") }}</th>
                                        <th v-for="label in skillLevelLabels" :key="label" class="skill-data-level">
                                          {{ label }}
                                        </th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr
                                        v-for="(row, rIdx) in table.rows"
                                        :key="rIdx"
                                        class="skill-data-row"
                                        :class="{ 'is-uniform': row.uniformValue !== null }"
                                      >
                                        <td class="skill-data-name">
                                          <span class="skill-data-label">{{ row.name }}</span>
                                          <span v-if="row.uniformValue !== null" class="skill-data-uniform">{{ row.uniformValue }}</span>
                                        </td>
                                        <td
                                          v-for="(seg, sIdx) in row.segments"
                                          :key="sIdx"
                                          class="skill-data-value"
                                          :colspan="seg.span"
                                        >
                                          {{ seg.value }}
                                        </td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </details>
                        </div>
                        <div v-else class="skill-multipliers">
                          <span v-for="(m, i) in skill.multipliers" :key="i">Lv{{i+1}}: {{m}}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="detail-section" v-if="currentCharacter.baseSkills">
                    <h3>{{ t("åå‹¤æŠ€èƒ½") }}</h3>
                    <div class="base-skills-grid">
                      <div v-for="bs in currentCharacter.baseSkills" :key="bs.name" class="base-skill-card">
                        <div class="base-skill-name">{{ bs.name }}</div>
                        <div class="base-skill-desc">{{ bs.description }}</div>
                      </div>
                    </div>
                  </div>
                  <div class="detail-section">
                    <h3>{{ t("å¤©èµ‹") }}</h3>
                    <div class="talents-list">
                      <div v-for="talent in currentCharacter.talents" :key="talent.name" class="talent-item">
                        <div class="talent-header">
                          <img v-if="talent.icon" :src="talent.icon" class="talent-icon" alt="" />
                          <div class="talent-name">{{ talent.name }}</div>
                        </div>
                        <p>{{ talent.description }}</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div v-show="strategyCategory === 'info' && strategyTab === 'potentials'" class="detail-panel">
                  <div class="detail-section">
                    <h3>{{ t("å¹²å‘˜æ½œèƒ½") }}</h3>
                    <div class="potential-grid">
                      <div v-for="(p, i) in currentCharacter.potentials" :key="i" class="potential-card">
                        <div class="potential-index">{{ t("æ½œèƒ½") }} {{ i + 1 }}</div>
                        <div class="potential-desc">{{ p }}</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div v-show="strategyCategory === 'guide' && strategyTab === 'analysis'" class="detail-panel">
                  <div class="detail-section">
                    <h3>{{ t("å¹²å‘˜è§£æ") }}</h3>
                    <p class="strategy-text">{{ (currentGuide && currentGuide.analysis) || t("æš‚æ— è§£æ") }}</p>
                  </div>
                  <div class="detail-section" v-if="currentGuide">
                    <h3>{{ t("é…è£…æ¨è") }}</h3>
                    <div class="gear-table" v-if="guideRows.length">
                      <div class="gear-row gear-row-head">
                        <div class="gear-row-label"></div>
                        <div class="gear-row-main">
                          <div class="gear-cell gear-weapon">{{ t("æ­¦å™¨") }}</div>
                          <div class="gear-cell">{{ t("æŠ¤ç”²") }}</div>
                          <div class="gear-cell">{{ t("æ‰‹å¥—") }}</div>
                          <div class="gear-cell">{{ t("é…ä»¶") }}</div>
                          <div class="gear-cell">{{ t("é…ä»¶") }}</div>
                        </div>
                      </div>
                      <div v-for="(row, idx) in guideRows" :key="idx" class="gear-row">
                        <div class="gear-row-label">
                          <div class="gear-tag-block">
                            <span
                              class="gear-tag"
                              :class="idx === 0 ? 'gear-tag-primary' : 'gear-tag-secondary'"
                            >
                              {{ idx === 0 ? t("ä¸»é€‰") : t("å¤‡é€‰") }}
                            </span>
                            <span class="gear-tag-desc">
                              {{ idx === 0 ? t("ä¼˜å…ˆæ¨è") : t("å¯æ›¿ä»£") }}
                            </span>
                          </div>
                        </div>
                        <div class="gear-row-main">
                          <div class="gear-cell gear-weapon">
                            <div class="gear-items">
                              <div v-for="(weapon, wIdx) in row.weapons" :key="wIdx" class="gear-item">
                                <div
                                  class="gear-icon-frame"
                                  :class="weapon.rarity === 6 ? 'weapon-rarity-6' : weapon.rarity === 5 ? 'weapon-rarity-5' : ''"
                                >
                                  <img v-if="weapon.icon" :src="weapon.icon" class="gear-icon" alt="" />
                                </div>
                                <div class="gear-text">
                                  <div class="gear-name">{{ weapon.name }}</div>
                                  <div class="gear-note" v-if="weapon.note">{{ weapon.note }}</div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div v-for="(equip, eIdx) in row.equipment" :key="eIdx" class="gear-cell">
                            <div v-if="equip" class="gear-item">
                              <div
                                class="gear-icon-frame"
                                :class="equip.rarity === 5 ? 'gear-rarity-5' : equip.rarity === 4 ? 'gear-rarity-4' : ''"
                              >
                                <img v-if="equip.icon" :src="equip.icon" class="gear-icon" alt="" />
                              </div>
                              <div class="gear-text">
                                <div class="gear-name">{{ equip.name }}</div>
                                <div class="gear-note" v-if="equip.note">{{ equip.note }}</div>
                              </div>
                            </div>
                            <div v-else class="gear-empty">-</div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="gear-empty" v-else>{{ t("æš‚æ— é…è£…") }}</div>
                  </div>
                </div>

                <div v-show="strategyCategory === 'guide' && strategyTab === 'team'" class="detail-panel">
                  <div class="detail-section">
                    <h3>{{ t("é…é˜Ÿæ€è·¯") }}</h3>
                    <p class="strategy-text">{{ (currentGuide && currentGuide.teamTips) || t("æš‚æ— å»ºè®®") }}</p>
                  </div>

                  <div class="detail-section">
                    <h3>{{ t("é˜Ÿä¼æ¨è") }}</h3>
                    <div class="team-table" v-if="teamSlots.length">
                      <div v-for="(slot, sIdx) in teamSlots" :key="'team-slot-' + sIdx" class="team-cell">
                        <div v-if="slot" class="team-slot">
                          <div
                            v-for="(entry, eIdx) in (slot.options || [])"
                            :key="'team-entry-' + sIdx + '-' + eIdx"
                            class="team-card"
                            :class="{
                              'is-alt': eIdx > 0,
                              'is-self': currentCharacter && entry.name === currentCharacter.name,
                            }"
                          >
                            <div class="team-name-row">
                              <img v-if="entry.avatar" :src="entry.avatar" class="team-member-avatar" alt="" loading="lazy" />
                              <div class="team-name">{{ entry.name }}</div>
                              <span
                                v-if="currentCharacter && entry.name === currentCharacter.name"
                                class="team-badge"
                              >
                                {{ t("å½“å‰") }}
                              </span>
                              <span v-if="entry.tag" class="team-badge muted">{{ entry.tag }}</span>
                            </div>
                            <div class="team-section">
                              <span class="team-label">{{ t("æ­¦å™¨") }}</span>
                              <div class="team-items">
                                <div v-for="(weapon, wIdx) in (entry.weapons || [])" :key="wIdx" class="team-item">
                                  <div
                                    class="team-icon-frame"
                                    :class="weapon.rarity === 6 ? 'weapon-rarity-6' : weapon.rarity === 5 ? 'weapon-rarity-5' : ''"
                                  >
                                    <img v-if="weapon.icon" :src="weapon.icon" class="team-icon" alt="" />
                                  </div>
                                  <div class="team-text">
                                    <div class="team-item-name">{{ weapon.name }}</div>
                                    <div class="team-note" v-if="weapon.note">{{ weapon.note }}</div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="team-section">
                              <span class="team-label">{{ t("è£…å¤‡") }}</span>
                              <div class="team-items">
                                <div v-for="(equip, eIdx) in (entry.equipment || [])" :key="eIdx" class="team-item">
                                  <div
                                    class="team-icon-frame"
                                    :class="equip.rarity === 5 ? 'gear-rarity-5' : equip.rarity === 4 ? 'gear-rarity-4' : ''"
                                  >
                                    <img v-if="equip.icon" :src="equip.icon" class="team-icon" alt="" />
                                  </div>
                                  <div class="team-text">
                                    <div class="team-item-name">{{ equip.name }}</div>
                                    <div class="team-note" v-if="equip.note">{{ equip.note }}</div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div v-else class="team-empty">-</div>
                      </div>
                    </div>
                    <div class="empty-guide" v-else>
                      <p class="empty-guide-text">{{ t("æš‚æ— æ¨è") }}</p>
                    </div>
                  </div>
                </div>

                <div v-show="strategyCategory === 'guide' && strategyTab === 'operation'" class="detail-panel">
                  <div class="detail-section">
                    <h3>{{ t("æ‰‹æ³•æ•™å­¦") }}</h3>
                    <p class="strategy-text">{{ (currentGuide && (currentGuide.operationTips || currentGuide.skillTips)) || t("æš‚æ— å»ºè®®") }}</p>
                  </div>
                </div>
              </div>

            </div>
              </div>
            </transition>
          </div>

          <div v-else key="reforging" class="view-shell reforging-view">
          <div class="empty-state">
            <h2>{{ t("è£…å¤‡ç²¾é”»") }}</h2>
            <p>{{ t("åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…...") }}</p>
          </div>
          </div>
        </transition>
      </main>

      <footer class="site-footer" aria-label="footer">
        <div class="site-footer-inner">
          <span class="footer-item">
            <span class="footer-label">{{ t("ç‰ˆæƒæ‰€æœ‰") }}</span>
            <span class="footer-value">Â© 2026 ç’¨æ¢¦è¸æœˆ</span>
          </span>
          <span class="footer-sep">Â·</span>
          <span class="footer-item">
            <span class="footer-label">{{ t("è®¸å¯è¯") }}</span>
            <a
              class="footer-link"
              href="https://www.gnu.org/licenses/agpl-3.0.html"
              target="_blank"
              rel="noreferrer"
            >
              AGPL-3.0
            </a>
          </span>
          <span class="footer-sep">Â·</span>
          <span class="footer-item">
            <span class="footer-label">{{ t("æºç ") }}</span>
            <a
              class="footer-link"
              href="https://github.com/cmyyx/endfield-essence-planner"
              target="_blank"
              rel="noreferrer"
            >
              GitHub
            </a>
          </span>
          <span class="footer-sep">Â·</span>
          <span class="footer-item">
            <span class="footer-label">{{ t("è”ç³»") }}</span>
            <a class="footer-link" href="mailto:contact@canmoe.com">
              contact@canmoe.com
            </a>
          </span>
          <span class="footer-item footer-item-disclaimer">
            <span class="footer-label">{{ t("ç´ æå£°æ˜") }}</span>
            <span class="footer-value footer-disclaimer-text">
              {{
                t(
                  "å½“å‰å›¾ç‰‡ç´ æå‡æ¥æºäºä¸Šæµ·é¹°è§’ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸åŠå…¶æ¸¸æˆã€Šæ˜æ—¥æ–¹èˆŸï¼šç»ˆæœ«åœ°ã€‹ï¼Œç›¸å…³ç‰ˆæƒå½’åŸæƒåˆ©æ–¹æ‰€æœ‰ã€‚æœ¬å·¥å…·ä»…ä¾›ç©å®¶äº¤æµä¸è¾…åŠ©è§„åˆ’ä½¿ç”¨ã€‚"
                )
              }}
            </span>
          </span>
        </div>
      </footer>

      <button
        class="back-to-top"
        :class="{ 'is-visible': showBackToTop }"
        :title="t('å›åˆ°é¡¶éƒ¨')"
        :aria-label="t('å›åˆ°é¡¶éƒ¨')"
        @click="scrollToTop"
      >
        â†‘
      </button>

      <transition name="fade-scale">
        <div v-if="showNotice" class="about-overlay notice-overlay" @click.self="closeNotice">
          <div class="about-card notice-card">
            <h3>{{ announcement.title }}</h3>
            <div class="notice-body">
              <p class="notice-meta">
                {{ t("æ›´æ–°æ—¥æœŸï¼š{date}", { date: announcement.date }) }}
              </p>
              <ul class="notice-list">
                <li
                  v-for="(item, index) in announcement.items"
                  :key="`${item}-${index}`"
                  v-html="formatNoticeItem(item)"
                ></li>
              </ul>
            </div>
            <div class="notice-footer">
              <div class="notice-qq" v-if="announcement.qqGroup">
                <a
                  class="ghost-button notice-join"
                  href="https://qm.qq.com/q/FBNLBtEPy8"
                  target="_blank"
                  rel="noopener"
                >
                  {{ t("åŠ å…¥ QQ ç¾¤") }}
                </a>
                <div class="notice-qq-info">
                  {{ t("QQ ç¾¤ï¼š{group}", { group: announcement.qqGroup }) }}
                  <span v-if="announcement.qqNote">ï¼ˆ{{ announcement.qqNote }}ï¼‰</span>
                </div>
              </div>
              <label class="notice-skip">
                <input type="checkbox" v-model="skipNotice" />
                {{ t("æœ¬æ¬¡å…¬å‘Šä¸å†æ˜¾ç¤º") }}
              </label>
              <div class="about-actions">
                <button class="ghost-button" @click="closeNotice">{{ t("å…³é—­") }}</button>
              </div>
            </div>
          </div>
        </div>
      </transition>

      <transition name="fade-scale">
        <div
          v-if="showChangelog"
          class="about-overlay changelog-overlay"
          @click.self="showChangelog = false"
        >
          <div class="about-card changelog-card">
            <h3>{{ changelog.title }}</h3>
            <div class="changelog-body">
              <div v-if="!changelog.entries || !changelog.entries.length" class="empty">
                {{ t("æš‚æ— æ›´æ–°æ—¥å¿—ã€‚") }}
              </div>
              <div
                v-else
                v-for="(entry, index) in changelog.entries"
                :key="entry.date || `changelog-${index}`"
                class="changelog-section"
              >
                <div class="changelog-date">{{ entry.date }}</div>
                <ul class="changelog-list">
                  <li v-for="item in entry.items" :key="item">{{ item }}</li>
                </ul>
              </div>
            </div>
            <div class="about-actions">
              <button class="ghost-button" @click="showChangelog = false">{{ t("å…³é—­") }}</button>
            </div>
          </div>
        </div>
      </transition>

      <transition name="fade-scale">
                <div v-if="showAbout" class="about-overlay about-overlay-main" @click.self="showAbout = false">
                  <div class="about-card about-main">
                    <h3>{{ aboutContent.title }}</h3>
                    <div class="about-body">
              <p v-for="(line, index) in aboutContent.paragraphs" :key="`about-line-${index}`">
                {{ line }}
              </p>
                      <p v-if="aboutContent.author">
                        {{ t("ä½œè€…ï¼š{name}", { name: aboutContent.author }) }}
                      </p>
                      <div
                        class="about-material-note"
                        v-if="aboutContent.materialNotice || aboutContent.materialDisclaimer"
                      >
                        <h4>{{ t("ç´ æè¯´æ˜ä¸å…è´£å£°æ˜") }}</h4>
                        <p v-if="aboutContent.materialNotice">{{ t(aboutContent.materialNotice) }}</p>
                        <p v-if="aboutContent.materialDisclaimer" class="about-material-disclaimer">
                          {{ t(aboutContent.materialDisclaimer) }}
                        </p>
                      </div>
                      <div class="about-links" v-if="aboutContent.links && aboutContent.links.length">
                <a
                  v-for="link in aboutContent.links"
                  :key="link.href || link.text"
                  class="repo-link"
                  :href="link.href"
                  target="_blank"
                  rel="noreferrer"
                >
                  <span class="repo-chip">{{ link.chip }}</span>
                  <span>{{ link.text }}</span>
                  <span class="repo-arrow">â†—</span>
                </a>
              </div>
              <div class="about-thanks" v-if="aboutContent.thanks && aboutContent.thanks.length">
                <h4>{{ t("æ„Ÿè°¢") }}</h4>
                <ul class="about-thanks-list">
                  <li
                    v-for="(entry, index) in aboutContent.thanks"
                    :key="entry.name || `about-thanks-${index}`"
                    class="about-thanks-item"
                  >
                    <div class="about-thanks-name">
                      <a v-if="entry.href" :href="entry.href" target="_blank" rel="noreferrer">
                        {{ entry.name }}
                        <span class="about-thanks-arrow">â†—</span>
                      </a>
                      <span v-else>{{ entry.name }}</span>
                    </div>
                    <div v-if="entry.note" class="about-thanks-note">{{ entry.note }}</div>
                  </li>
                </ul>
              </div>
              <div
                class="about-sponsor"
                v-if="aboutContent.sponsor && aboutContent.sponsor.items && aboutContent.sponsor.items.length"
              >
                <h4>{{ t(aboutContent.sponsor.title || "èµåŠ©æ”¯æŒ") }}</h4>
                <p v-if="aboutContent.sponsor.text" class="about-sponsor-text">
                  {{ t(aboutContent.sponsor.text) }}
                </p>
              <div class="about-sponsor-grid">
                <div
                  v-for="(item, index) in aboutContent.sponsor.items"
                  :key="item.label || item.src || `about-sponsor-${index}`"
                  class="about-sponsor-item"
                >
                  <img
                    :src="item.src"
                    :alt="item.label ? t(item.label) : ''"
                    loading="lazy"
                    decoding="async"
                  />
                  <div v-if="item.label" class="about-sponsor-label">
                    {{ t(item.label) }}
                  </div>
                </div>
              </div>
              <div
                v-if="aboutContent.sponsor.list && aboutContent.sponsor.list.length"
                class="about-sponsor-list"
              >
                <h5>{{ t("èµåŠ©åˆ—è¡¨") }}</h5>
                <ul class="about-sponsor-list-items">
                  <li
                    v-for="(entry, index) in aboutContent.sponsor.list"
                    :key="entry.name || `about-sponsor-entry-${index}`"
                    class="about-sponsor-entry"
                  >
                    <div class="about-sponsor-entry-name">{{ entry.name }}</div>
                    <div
                      v-if="entry.amount || entry.date"
                      class="about-sponsor-entry-meta"
                    >
                      <span v-if="entry.amount" class="about-sponsor-entry-amount">
                        {{ entry.amount }}
                      </span>
                      <span v-if="entry.date" class="about-sponsor-entry-date">
                        {{ entry.date }}
                      </span>
                    </div>
                    <div v-if="entry.note" class="about-sponsor-entry-note">
                      {{ entry.note }}
                    </div>
                  </li>
                </ul>
              </div>
            </div>
            </div>

            <div class="about-actions">
              <button class="ghost-button" @click="showAbout = false">{{ t("å…³é—­") }}</button>
            </div>
          </div>
        </div>
      </transition>

      <transition name="fade-scale">
          <div v-if="tutorialActive" class="tutorial-float">
          <div class="tutorial-card">
            <div class="tutorial-head-row">
              <div class="tutorial-step">
                {{ t("æ–°æ‰‹æ•™ç¨‹ {current} / {total}", {
                  current: tutorialStepIndex + 1,
                  total: tutorialTotalSteps,
                }) }}
              </div>
              <button
                v-if="tutorialBodyCanCollapse"
                class="ghost-button tutorial-collapse"
                :class="{ 'tutorial-highlight': tutorialCollapseHighlight }"
                @click="toggleTutorialBody"
              >
                {{ tutorialBodyCollapsed ? t("å±•å¼€è¯´æ˜") : t("æ”¶èµ·è¯´æ˜") }}
              </button>
            </div>
            <h3>{{ tutorialStep.title }}</h3>
            <p
              v-for="(line, index) in tutorialVisibleLines"
              :key="`tutorial-line-${index}`"
              :class="{
                'tutorial-line-cut':
                  tutorialBodyCollapsed &&
                  isPortrait &&
                  index === tutorialVisibleLines.length - 1
              }"
            >
              {{ line }}
            </p>
            <div class="tutorial-status">
              <span v-if="tutorialStepReady">{{ t("å·²å®Œæˆï¼Œå¯ç»§ç»­ã€‚") }}</span>
              <span v-else>{{ t("è¯·æŒ‰æç¤ºå®Œæˆå½“å‰æ“ä½œã€‚") }}</span>
            </div>
            <div class="tutorial-actions">
              <button
                class="ghost-button"
                @click="prevTutorialStep"
                :disabled="tutorialStepIndex === 0"
              >
                {{ t("ä¸Šä¸€æ­¥") }}
              </button>
              <button class="ghost-button" @click="openTutorialSkipConfirm">
                {{ t("è·³è¿‡å…¨éƒ¨") }}
              </button>
              <button
                v-if="tutorialStepKey === 'base-pick' && !tutorialStepReady"
                class="ghost-button"
                @click="skipTutorialStep"
              >
                {{ t("è·³è¿‡æœ¬æ­¥") }}
              </button>
              <button
                class="about-button"
                @click="nextTutorialStep"
                :disabled="!tutorialStepReady"
              >
                {{
                  tutorialStepIndex + 1 >= tutorialTotalSteps
                    ? t("å®Œæˆ")
                    : t("ä¸‹ä¸€æ­¥")
                }}
              </button>
            </div>
          </div>
        </div>
      </transition>

      <transition name="fade-scale">
        <div v-if="showTutorialSkipConfirm" class="about-overlay" @click.self="closeTutorialSkipConfirm">
          <div class="about-card tutorial-modal">
            <h3>{{ t("è·³è¿‡æ–°æ‰‹æ•™ç¨‹ï¼Ÿ") }}</h3>
            <p>{{ t("ç¡®å®šè·³è¿‡å½“å‰ç‰ˆæœ¬çš„æ–°æ‰‹æ•™ç¨‹å—ï¼Ÿæ­¤æ“ä½œä»…å¯¹å½“å‰ç‰ˆæœ¬ç”Ÿæ•ˆã€‚") }}</p>
            <p class="tutorial-note">{{ t("ä¹‹åå¯åœ¨â€œæ›´å¤šè®¾ç½®â€ä¸­å†æ¬¡ä½“éªŒã€‚") }}</p>
            <div class="about-actions">
              <button class="ghost-button" @click="closeTutorialSkipConfirm">{{ t("å–æ¶ˆ") }}</button>
              <button class="about-button" @click="confirmTutorialSkipAll">
                {{ t("è·³è¿‡å…¨éƒ¨") }}
              </button>
            </div>
          </div>
        </div>
      </transition>

      <transition name="fade-scale">
        <div v-if="showTutorialComplete" class="tutorial-float">
          <div class="tutorial-card tutorial-complete-card">
            <div class="tutorial-step">{{ t("æ–°æ‰‹æ•™ç¨‹å®Œæˆ") }}</div>
            <h3>{{ t("æ­å–œå®Œæˆæ–°æ‰‹æ•™ç¨‹") }}</h3>
            <p>{{ t("ä½ å·²å®Œæˆå½“å‰ç‰ˆæœ¬çš„æ–°æ‰‹æ•™ç¨‹ã€‚") }}</p>
            <p>{{ t("å¦‚æœä½ è®¤ä¸ºæ–°æ‰‹æ•™ç¨‹éœ€è¦æ”¹è¿›æ¬¢è¿æä¾›å»ºè®®ã€‚") }}</p>
            <p class="tutorial-note">{{ t("å¯åœ¨â€œæ›´å¤šè®¾ç½®â€ä¸­å†æ¬¡ä½“éªŒã€‚") }}</p>
            <div class="tutorial-actions">
              <button class="about-button" @click="closeTutorialComplete">{{ t("çŸ¥é“äº†") }}</button>
            </div>
          </div>
        </div>
      </transition>

      <div v-if="showDomainWarning" class="domain-overlay">
        <div class="domain-card">
          <h3>{{ t("éå®˜æ–¹åŸŸåæç¤º") }}</h3>
          <p>
            {{ t("å½“å‰è®¿é—®åŸŸåå¹¶é") }}
            <a class="domain-link" href="https://end.canmoe.com" target="_blank" rel="noreferrer">
              end.canmoe.com
            </a>
            {{ t("è¯·ç¡®è®¤æ˜¯å¦ä¸ºå¯ä¿¡æ¥æºï¼Œè°¨é˜²æ¶æ„æ˜ å°„æˆ–é¡µé¢è¢«å†…åµŒç¯¡æ”¹ã€‚") }}
          </p>
          <p class="domain-chip">{{ t("å½“å‰é¡µé¢åŸŸåï¼š{host}", { host: currentHost }) }}</p>
          <p v-if="isEmbedded" class="domain-chip">
            {{ t("ä¸Šå±‚é¡µé¢åŸŸåï¼š{host}", { host: embedHostLabel }) }}
          </p>
          <p v-if="isEmbedded && !isEmbedTrusted">{{ t("è¯¥åŸŸåæœªåœ¨å†…åµŒç™½åå•å†…ã€‚") }}</p>
          <p v-if="isEmbedded">{{ t("æ£€æµ‹åˆ°é¡µé¢è¢«å†…åµŒï¼ˆiframeï¼‰æ‰“å¼€ï¼Œæ­¤æç¤ºæ— æ³•å…³é—­ã€‚") }}</p>
          <div class="about-actions domain-actions">
            <a
              class="repo-link domain-primary"
              href="https://end.canmoe.com"
              target="_blank"
              rel="noreferrer"
            >
              <span class="repo-chip">OFFICIAL</span>
              <span>{{ t("è®¿é—®å®˜æ–¹åŸŸå") }}</span>
              <span class="repo-arrow">â†—</span>
            </a>
            <button
              v-if="!isEmbedded"
              class="ghost-button"
              :disabled="warningCountdown > 0"
              @click="dismissDomainWarning"
            >
              {{
                warningCountdown > 0
                  ? t("æˆ‘å·²çŸ¥æ™“ï¼ˆ{count}sï¼‰", { count: warningCountdown })
                  : t("æˆ‘å·²çŸ¥æ™“")
              }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function () {
        const version =
          document.documentElement.dataset.assetVersion ||
          (document.lastModified || String(Date.now())).replace(/\D/g, "");
        const loadScript = (src) =>
          new Promise((resolve, reject) => {
            const script = document.createElement("script");
            script.src = src + "?v=" + version;
            script.onload = () => resolve();
            script.onerror = () => reject(new Error("Failed to load: " + src));
            document.body.appendChild(script);
          });
        const vuePromise = loadScript("./vendor/vue.global.prod.js");
        const dataPromise = Promise.all([
          loadScript("./data/dungeons.js"),
          loadScript("./data/weapons.js"),
          loadScript("./data/weapon-images.js"),
          loadScript("./data/i18n.zh-CN.js"),
          loadScript("./data/i18n.zh-TW.js"),
          loadScript("./data/i18n.en.js"),
          loadScript("./data/i18n.ja.js"),
          loadScript("./data/sponsors.js"),
          loadScript("./data/content.js"),
          loadScript("./data/characters.js"),
          loadScript("./data/characters/ember.js"),
          loadScript("./data/characters/perlica.js"),
        ]);
        Promise.all([vuePromise, dataPromise])
          .then(() => loadScript("./js/app.js"))
          .catch(() => {
            document.body.innerHTML =
              "<div style='padding:24px;color:#f36c6c;font-family:Microsoft YaHei UI;'>èµ„æºåŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°æˆ–æ£€æŸ¥ç½‘ç»œç¼“å­˜ã€‚</div>";
          });
      })();
    </script>
  </body>
</html>

